"use strict";define(["knockout","pubsub","modules/player"],function(a,e,t){var o="blitz";return function(n){var r=this;this.clearGameData=function(){localStorage.setItem(o,"")},this.saveGameData=function(){var e={};e.players=n.players(),e.score=n.score.gameEndScore(),e.rounds=n.round.rounds(),localStorage.setItem(o,a.toJSON(e))},this.loadGameData=function(){var a,n=localStorage.getItem(o),r=[];return n?(a=JSON.parse(n),e.publish("perist.load",a),r.length>0?r:[new t]):[new t]},window.onbeforeunload=function(){r.saveGameData()},e.subscribe("game.save",function(){r.saveGameData()}),e.subscribe("game.load",function(){r.loadGameData()})}});