"use strict";define(["knockout","pubsub","modules/player"],function(a,e,t){var o="blitz";return function(n){var s=this;this.clearGameData=function(){localStorage.setItem(o,"")},this.saveGameData=function(){var e={};e.players=n.players(),e.score=n.score.gameEndScore(),e.rounds=n.round.rounds(),e.undo=n.undo.plays(),localStorage.setItem(o,a.toJSON(e))},this.loadGameData=function(){var a,n=localStorage.getItem(o),s=[];return n?(a=JSON.parse(n),e.publish("perist.load",a),s.length>0?s:[new t]):[new t]},window.onbeforeunload=function(){s.saveGameData()},e.subscribe("game.save",function(){s.saveGameData()}),e.subscribe("game.load",function(){s.loadGameData()})}});