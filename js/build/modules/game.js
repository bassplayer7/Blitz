"use strict";define(["knockout","pubsub","hammerjs","modules/player","modules/score","modules/persist","modules/round","modules/complete"],function(e,s,r,t,n,a,o,i){return function(){var r=this;r.players=e.observableArray([new t]),this.persist=new a(r),this.score=new n(r),this.round=new o(r),this.complete=new i(r),this.entryInProgress=!0,this.addPlayer=function(){r.players.push(new t)},this.removePlayer=function(e){e.currentScore()<1?r.players.remove(e):confirm("Are you sure you want to delete this player?")&&r.players.remove(e)},this.clearGame=function(){s.publish("game.clear",{}),r.persist.clearGameData(),ga("send","event","Game","New"),r.players(r.persist.loadGameData())},this.newGame=function(){r.players().length<1?r.clearGame(r.players()):confirm("Are you sure you want to clear this game and start over?")&&r.clearGame(r.players())},this.resetGame=function(e){(e===!0||confirm("Are you sure you want to clear all scores?"))&&(ga("send","event","Game","Reset Scores"),s.publish("game.reset",{}),r.persist.clearGameData())},this.gameInSetupMode=function(){return r.players()[0]&&!r.players()[0].name()||!r.score.topScore()},this.gameFirstView=function(){return r.players()[0]&&!r.players()[0].name()};var l=null;this.scoreBeingEntered=function(){r.entryInProgress=!0,window.clearTimeout(l),l=window.setTimeout(function(){r.entryInProgress=!1},1e3)},this.centerGame=function(){setTimeout(function(){r.entryInProgress||window.scroll({top:document.getElementsByClassName("scoreboard__block")[0].offsetTop,behavior:"smooth"})},200)},this.tipsVisible=e.observable(!1),this.toggleUserHelp=function(){r.tipsVisible(!r.tipsVisible())},r.players.subscribe(r.persist.saveGameData),s.subscribe("perist.load",function(e,n){if(n.hasOwnProperty("players")){var a=n.players;for(var o in a)a[o]=new t(a[o]);r.players(a)}s.publish("game.ready",{})}),s.publish("game.load",r),[].forEach.call(document.getElementsByClassName("js-vote"),function(e){e.addEventListener("click",function(e){e.removeAttribute("onclick"),e.textContent="Thanks!"})})}});