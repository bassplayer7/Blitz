"use strict";define(["knockout","pubsub","hammerjs","modules/player","modules/score","modules/persist","modules/round","modules/complete"],function(e,s,t,r,n,a,o,i){return function(){var t=this;t.players=e.observableArray([new r]),this.persist=new a(t),this.score=new n(t),this.round=new o(t),this.complete=new i(t),this.entryInProgress=!0,this.addPlayer=function(){t.players.push(new r)},this.removePlayer=function(e){e.currentScore()<1?t.players.remove(e):confirm("Are you sure you want to delete this player?")&&t.players.remove(e)},this.undo=function(){},this.clearGame=function(){s.publish("game.clear",{}),t.persist.clearGameData(),ga("send","event","Game","New"),t.players(t.persist.loadGameData())},this.newGame=function(){t.players().length<1?t.clearGame(t.players()):confirm("Are you sure you want to clear this game and start over?")&&t.clearGame(t.players())},this.resetGame=function(e){(e===!0||confirm("Are you sure you want to clear all scores?"))&&(ga("send","event","Game","Reset Scores"),s.publish("game.reset",{}),t.persist.clearGameData())},this.gameInSetupMode=function(){return t.players()[0]&&!t.players()[0].name()||!t.score.topScore()},this.gameFirstView=function(){return t.players()[0]&&!t.players()[0].name()};var l=null;this.scoreBeingEntered=function(){t.entryInProgress=!0,window.clearTimeout(l),l=window.setTimeout(function(){t.entryInProgress=!1},1e3)},this.centerGame=function(){setTimeout(function(){t.entryInProgress||window.scroll({top:document.getElementsByClassName("scoreboard__block")[0].offsetTop,behavior:"smooth"})},200)},this.tipsVisible=e.observable(!1),this.toggleUserHelp=function(){t.tipsVisible(!t.tipsVisible())},t.players.subscribe(t.persist.saveGameData),s.subscribe("perist.load",function(e,n){if(n.hasOwnProperty("players")){var a=n.players;for(var o in a)a[o]=new r(a[o]);t.players(a)}s.publish("game.ready",{})}),s.publish("game.load",t),[].forEach.call(document.getElementsByClassName("js-vote"),function(e){e.addEventListener("click",function(e){e.removeAttribute("onclick"),e.textContent="Thanks!"})})}});